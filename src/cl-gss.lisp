(in-package :cl-gss)

(declaim #.*compile-decl*)

(defmacro gss-call (minor-sym form)
  (check-type minor-sym symbol)
  (let ((status-sym (gensym "STATUS-")))
    `(cffi:with-foreign-objects ((,minor-sym 'om-uint32))
       (let ((,status-sym ,form))
         (when (error-p ,status-sym)
           (raise-error ,status-sym (cffi:mem-ref ,minor-sym 'om-uint32) gss-mech-krb5))
         ,status-sym))))

(defmacro with-foreign-buffer-from-byte-array ((sym buffer) &body body)
  (let ((s (gensym "FOREIGN-BUFFER-")))
    `(let ((,s (array-to-foreign-char-array ,buffer)))
       (unwind-protect
            (let ((,sym ,s))
              (progn ,@body))
         (cffi:foreign-free ,s)))))

(defmacro with-buffer-desc ((sym buffer) &body body)
  (let ((array-copy (gensym "ARRAY-"))
        (mem-sym (gensym "MEM-"))
        (buffer-sym (gensym "EXTERNAL-BUFFER-")))
    `(let ((,array-copy ,buffer))
       (with-foreign-buffer-from-byte-array (,mem-sym buffer)
         (cffi:with-foreign-objects ((,buffer-sym '(:struct gss-buffer-desc)))
           (setf (buffer-desc-length ,buffer-sym) (length ,array-copy))
           (setf (buffer-desc-value ,buffer-sym) ,mem-sym)
           (let ((,sym ,buffer-sym))
             ,@body))))))

(defclass gss-memory-mixin ()
  ((ptr :reader gss-memory-mixin-ptr
        :initarg :ptr
        :documentation "The wrapped pointer"))
  (:documentation "Mixing class for types that wraps a pointer needs to
be released after the instance is no longer referenced. The actual
registration of the object is handled by the subclass."))

(defclass name (gss-memory-mixin)
  ()
  (:documentation "Wrapper class for instances of gss-name-t"))

(defmethod initialize-instance :after ((obj name) &key &allow-other-keys)
  (let ((ptr (gss-memory-mixin-ptr obj)))
    (trivial-garbage:finalize obj #'(lambda ()
                                      (cffi:with-foreign-objects ((n 'gss-name-t))
                                        (setf (cffi:mem-ref n 'gss-name-t) ptr)
                                        (gss-call m (gss-release-name m n)))))))

(defclass context (gss-memory-mixin)
  ()
  (:documentation "Wrapper class for instances of gss-ctx-id-t"))

(defmethod initialize-instance :after ((obj context) &key &allow-other-keys)
  (let ((ptr (gss-memory-mixin-ptr obj)))
    (trivial-garbage:finalize obj #'(lambda ()
                                      (cffi:with-foreign-objects ((h 'gss-ctx-id-t)
                                                                  (output '(:struct gss-buffer-desc)))
                                        (setf (cffi:mem-ref h 'gss-ctx-id-t) ptr)
                                        (gss-call m (gss-delete-sec-context m h output)))))))

(define-condition gss-error (error)
  ((major-errors :type list
                 :initarg :major-errors
                 :reader gss-error-major-messages
                 :documentation "List of major error messages")
   (minor-errors :type list
                 :initarg :minor-errors
                 :reader gss-error-minor-messages
                 :documentation "List of minor error messages"))
  (:report (lambda (condition out)
             (format out "GSS error:ネ彡矧湖狺ネ轭矧湖狺ㄧ篌弪蝻颦磲觑颦礤篌徵弩泔钿轸轱瞟ㄧ篌弪蝻颦黹铒颦礤篌徵弩泔钿轸轱瞟┅ê滹沲礤铘狒轱⑴蝌矧翳狒轶蜥轶邃麒孱怯恿猩骢钽糸镱蝈趱蝾犷弪蝻颌┅ㄤ彐躅蜥轶瀛弪蝻磲觑黹铒黹铒颦礤汨镩洎ㄤ弩趄蹉趱蜷铉忾钿磲觑颦礤篌徵弩黹铒颦礤篌徵弩ㄥ蝌矧蟓狍篝蜷铉磲觑黹铒黹铒颦礤汨镩洎ㄥ蝌矧х篌弪蝻喉彡矧弪蝻蝮磲觑颦礤篌徵弩喉轭矧弪蝻蝮黹铒颦礤篌徵弩┅ㄤ彐躅汜祆轭绛弪蝻颦ㄣ镤濠铒弪镳祜玑钿泔溴ㄡ箬珞蟓悱汜祆轭绛弪蝻颦磲箅珞蟓悱汜祆轭绛弪蝻颦镦骟弭┅┅ㄤ彐躅蝻豸轭瀛弪蝻颦ㄣ镤濠铒弪镳祜玑钿泔溴ㄡ箬珞蟓悱蝻豸轭瀛弪蝻颦磲箅珞蟓悱蝻豸轭瀛弪蝻颦镦骟弭┅┅ㄤ彐躅篚痧戾礤铘狎轭骘ㄣ镤濠铒弪镳祜玑钿泔溴ㄡ箬珞蟓悱篚痧戾礤铘狎磲箅珞蟓悱篚痧戾礤铘狎镦骟弭┅┅ㄤ彐躅弪蝻颦ㄣ镤濠矧ㄣ犰扉铉弪蝻颦泔溴蝻豸轭瀛弪蝻颦泔溴┅ㄤ彐躅泔铘轭蹂铄邃邃蝈篚祠ǒ祜玑钿蝈篚祠珞蟓蟓泔铘轭蹂铄邃邃癌ㄤ彐躅屮趄徙舡弪蝻颦礤篌徵篝狒躞篝狒躞泔溴豉疱礤汨ㄣ骀楹鏖翳骘蝈殓瞽镡赍泗è礤篌徵瀛泔铘屮э憝蹰铘巢┅箦翩ㄣ骀楹礤憝蝈礤篌徵瀛泔铘屮э憝蹰铘巢癌祜镳蝈疱狒序弼孱桢狃秭弪骒秣殒翳祜镳铄鲥屮轸泔祆邈ㄣ骀楹鏖翳骘蝈殓瞽镡赍泗è黹铒э憝蹰铘巢篝狒躞秕麴豸Ж后趄蹉珞蟓怩骀弪溴筱┅戾è溟箴灬蝈篚祠ㄧ篌溟箴灬篝狒躞黹铒篝狒躞篝狒躞泔溴豉疱礤汨礤篌徵瀛泔铘屮篝狒躞秕麴豸┅躅鏖钿痱雉邈痱镧麒孱ㄥ蝌矧溟箴灬蝈篚祠ㄥ蝌矧汜祆麸珞蟓溟箴灬篝狒躞驷殪邃鏖翳篝狒躞浸螈溟箴灬蝈篚祠┅ㄣ骀楹骘蝈殓瞽篝蜷铉麸扉箴ㄢ蹑驽颦溴筱鲠祯篝狒躞秕麴豸恒秕铘ㄢ蹑驽颦溴筱戾铉翳篝狒躞秕麴豸┅麒孱ㄥ蝌矧ㄧ篌蝈戾狍瀛怩骀弪黹铒篝狒躞秕麴豸┅ㄥ蝌矧㈡衢戾麸蝈戾狍礤盹蝙骝镯珞蟓溟箴灬篝狒躞┅┅躅糸弪镳ㄣ骀楹礤憝蝈礤篌徵瀛泔铘屮э憝蹰铘巢┅┅ㄤ彐躅弪蝻蝮狍篝蜷铉磲觑颦篝狒躞镳糸镱犰黹铒颦篝狒躞黹铒颦礤汨镩洎灬忮祗ī麒孱ㄥ蝌矧磲觑颦篝狒躞扉篝ㄥ趄徙舡弪蝻颦礤篌徵磲觑颦篝狒躞珞蟓悱珞蟓泔溴珞蟓悱铒镩洫ㄩㄡ钿黹铒颦篝狒躞黹铒颦礤汨镩铒ㄥ蝌矧黹铒颦篝狒躞┅ㄥ趄徙舡弪蝻颦礤篌徵黹铒颦篝狒躞珞蟓悱礤汨泔溴黹铒颦礤汨镩洎铋飑┅┅ㄤ彐躅泔铞弪舡麸怡翦ㄡ蝌狴灬忮祗è黼怡翦ㄡ戾è蝈篚祠磲脲狎蜥戾铉翳岍哄戾礤铘豉疱Ж躅箝珙邃怡翦俯┅磲瓠轭麸蝈篚祠＇灬礅溽雯躅戾篌豉疱Ж躅箝珙邃怡翦俯ㄥ蝌矧⒅犰蹂轭轭瘐狎蜥轶铒犷ㄕ斡汕闻沫沦耘俯雯雯狎蜥蝈篚祠┅豉疱汜箦狎蜥è箝眇戾狎蜥躅箝珙邃怡翦俯í┅狎蜥黼怡翦狎蜥┅┅ㄤ彐躅狎蜥麸骘蝈殓瞽汨狎狎蜥ㄡ蝌狴戾è蝈篚祠ㄣ镱鲥螋麸怡翦狎蜥┅换孽麸怩轭谅锰闷粕好衔峙以韵葡遗汕汜铑雉忮躞邃换疹糸翳轶怩轶骈邃戾臾牾篝躞黠螂狎秕钿－徕沆ㄣ骀楹泔铞弪舡麸骘蝈殓蝈篚祠扉篝横蝌狴乎铙殓铄洵汨狎戾铉翳蝈篚祠┅＋徕沆戾舄è戾铉翳戾铉翳蝈篚祠┅豉疱扉篝横蝌狴乎铙殓铄洵汨狎戾铉翳┅ㄦ矧彘珙狎蜥ㄣ骀楹骘蝈殓瞽犰祜豉疱恒秕铘戾铉翳┅祜镳骘徙蝻篌蝈篚祠骘骝镯滹箦翩ㄣ骀楹礤憝狎彐骘蝈殓瞽狎蜥乎铙殓铄洵汨狎椹雯骘蝈殓瞽狎蜥┅ㄤ彐躅麸脲瞽踞蝌狴麸脲瞟ㄩㄣ骀楹铛祆痫轭翦颦麸脲瞟铋ㄣ镱鲥螋麸怡翦ㄣ骀楹泔铞弪舡骝镯骘蝈殓ㄢ蹑驽颦溴筱鲠祯麸脲瞟扉篝横蝌狴乎铙殓铄洵汨狎ㄣ骀楹泔铞弪舡骝镯骘蝈殓ㄢ蹑驽颦溴筱戾铉翳麸脲瞟э憝蹰铘巢┅┅┅ㄤ彐躅磲脲钺礤钺礤篝蜷铉⒚蝈狒铄钺礤镡赍泗蝈痱弩孱糸铉翳玳鲥钺礤澡轶骢钽糸镱轫痨屙孱趔翳骢钽糸镱犰轸镦翳怯恿猩骢钽糸镱噻篌唛眇矧暨钺礤Мㄣ桢汶豉疱钺礤篝蜷铉篝蜷铉ㄣ骀楹鏖翳骘蝈殓瞽篝蜷铉è骘蝈殓瞽钺礤篝蜷铉骘蝈殓瞽钺礤篝蜷铉戾铉翳钺礤篝蜷铉侯蹯飙翦蝽轭狒邃铋飑ㄣ骀楹鏖翳骘蝈殓瞽镡赍泗è怩Ж后趄蹉珞蟓怩骀弪溴筱┅秕麴豸钺礤х篌钺礤舂箦翩ㄢ蹑驽颦溴筱戾铉翳怩姗骘蝈殓瞽钺礤篝蜷铉戾铉翳箦翩ㄢ蹑驽颦溴筱鲠祯怩姗骘蝈殓瞽钺礤篝蜷铉ㄧ篌汜祆黹铒ㄧ篌轫痫螋钺礤黹铒怩珞蟓悱铘栾篝忉箦洵箦蝣殂濯秕麴豸钺礤┅磲脲轭篝犷沐ь犴吼趄ㄣ骀楹礤憝蝈秕麴豸钺礤х篌钺礤舂┅┅ㄤ彐躅钺礤麸篝蜷铉钺礤⒁弭躜翳篝蜷铉蝈痱弩孱翎糸镱镦瘟团ㄣ桢汶豉疱钺礤钺礤ㄣ骀楹鏖翳骘蝈殓瞽镡赍泗è秕麴豸钺礤Ж后趄蹉珞蟓怩骀弪溴筱┅秕麴豸豉疱х篌镩洎ㄧ篌汜祆ㄧ篌溟箴灬钺礤ㄧ篌礤盹蝙黹轭痿钺礤秕麴豸钺礤秕麴豸豉疱┅躅鏖钿痱雉邈鲠祯弩ㄣ骀楹骘蝈殓瞽篝蜷铉麸扉箴ㄢ蹑驽颦溴筱鲠祯秕麴豸钺礤恒秕铘ㄢ蹑驽颦溴筱戾铉翳秕麴豸钺礤┅ㄧ篌汜祆ㄧ篌蝈戾狍瀛怩骀弪秕麴豸钺礤┅┅ㄤ彐躅泔眇狎瀛钺礤钺礤钺礤博⒚镯疳蝈赭钺礤镡赍泗螽澡轶骢钽糸镱蝈趱蝾铒瞽紊殒翳赭钺礤镡赍泗蝈驽蝮麸翳筢礤孱糸豉澡轶骢钽糸镱轫痨屙孱趔翳骢钽糸镱犰轸镦翳怯恿猩骢钽糸镱噻篌咩镯疳蝈哳犴濮ㄣ桢汶豉疱钺礤钺礤ㄣ桢汶豉疱钺礤钺礤ㄣ骀楹鏖翳骘蝈殓瞽镡赍泗è蝈篚祠洪铘┅ㄧ篌汜祆ㄧ篌泔眇狎瀛钺礤ㄧ篌礤盹蝙黹轭痿钺礤暴ㄧ篌礤盹蝙黹轭痿钺礤博蝈篚祠┅铒弪镳ㄣ骀楹礤憝蝈蝈篚祠洪铘┅┅ㄤ彐躅磲脲骒徵ㄦ灬珞祜镳鏖翳蝈篚祠骘骒徵轭骒徵滹箦翩蝈篚祠祜玳矧蝈篚祠ㄥ汜箦骒徵ê溴戾珞蟓悱溴戾绛骒徵ê眭趱犰珞蟓悱眭趱犰骒徵ê蝈痨狴珞蟓悱蝈痨狴骒徵ê箦聃孱沐珞蟓悱箦聃孱沐骒徵ê泔铈珞蟓悱泔铈骒徵ê轭翦珞蟓悱轭翦绛骒徵ê犷镱珞蟓悱犷镱骒徵┅┅骈钺祆蝈趱蝾蝈篚祠┅ㄤ彐躅磲脲骒徵蟓扉篝鲠祯濠祜镳骘ㄦ灬骒徵鲠祯濠轭啜ê溴戾珞蟓悱溴戾绛骒徵ê眭趱犰珞蟓悱眭趱犰骒徵ê蝈痨狴珞蟓悱蝈痨狴骒徵ê箦聃孱沐珞蟓悱箦聃孱沐骒徵ê泔铈珞蟓悱泔铈骒徵ê轭翦珞蟓悱轭翦绛骒徵ê犷镱珞蟓悱犷镱骒徵ê痱雉蝈徜珞蟓悱痱雉蝈徜骒徵ê趄犷珞蟓悱趄犷蟓骒徵┅麒孱铒弪镳祜玑钿鲠祯骒徵鲠祯濠┅泔祆邈骒徵┅ㄤ彐躅珏舡矧犰祜汜翦泔铘屮ㄣ镱翦舂ㄩ泔铘屮ㄧ篌礤盹蝙黹轭痿泔铘屮舂珞蟓悱铒泔铘屮舂换换身痨屙孱翎糸镱镦珞筮轭轸唧邈咩镱翦换ㄤ彐躅轭轸箦翎蜱弭脲骒徵糸礤蝈癌泔铘屮轭瘐舡麸脲瞟⑸铋糸犰轶怯箦沲蜷豉泔铘屮舢澡轶骢钽糸镱轫痨屙孱趔翳骢钽糸镱犰轸镦翳怯恿猩骢钽糸镱噻篌唛铋暨箦氵泔铘屮臾澡轶骢钽糸镱蝈趱蝾翳骘祆秣轭鲠祯弩孟卧晌张闻拍拍铒瞽紊殒翳泔铘屮铄邃蝈痨骘蝽翳蝈盹翦箦蝣殂忮骘蝈轸汜忮躞邃孟卧咆翳泔铘屮翳狒轶躞邃麸蝈驽麸翳轶箴邈殒殂箦篌轱抡破乓翳怩骀弪翳狒箬秕熹忮箦铘麸翳蝈盹翦箦蝣殂铺燎扉篝镦骒徵翳狒溴筱蜷忮鲠蜷秕痱镳弪糸弩镦翳箦篌轱町痫篌殁戾骒徵蠛耗盘徘和赵樟态阂判塘佻河叛张蚊努好衔片荷卧徘毫蜗微ㄣ桢汶豉疱翎蜱弭矧篝蜷铉钺礤┅ㄣ桢汶豉疱骒徵扉篝ㄣ桢汶豉疱糸礤蝈ㄩ铘彗弪癌ㄣ桢汶豉疱泔铘屮矧铛祆泔铘屮舂ㄣ桢汶豉疱轭瘐舡麸脲矧铛祆鲥泗矧┅戾è钺礤ㄩ篝蜷铉翎蜱弭磲脲钺礤翎蜱弭翎蜱弭┅轭瘐舡麸脲瞽怩骀弪ㄣ骀楹鏖翳骘蝈殓瞽镡赍泗è轭瘐舡麸脲瞽泔铘孱Ж后趄蹉珞蟓怩骀弪溴筱┅ㄣ镱翦舡栳钿戾х篌泗殇舂ㄡ泗踽飙礤汨豉疱х篌镩洎秕麴豸麸脲Ж后趄蹉珞蟓怩骀弪溴筱┅蝈舡骒徵э憝蹰铘巢糸礤蝈э憝蹰铘巢┅箦翩ㄣ骀楹礤憝蝈泔铘屮舡栳钿戾х篌泗殇舂ㄧ弭矧犰祜汜翦泔铘屮泔铘屮舂ㄩ轭瘐舡麸脲换族栳鲥犷轭瘐麸脲瞵骈祆轸轭痱镧箦赳轭瘐舡麸脲瞽怩骀弪ㄡ蝌狴麸骘蝈殓瞽汨狎狎蜥轭瘐舡麸脲瞟箦翩ㄢ蹑驽颦溴筱戾铉翳轭瘐舡麸脲瞽泔铘孱舂戾铉翳轭瘐舡麸脲瞟箦翩ㄢ蹑驽颦溴筱鲠祯轭瘐舡麸脲瞽泔铘孱舂轭瘐舡麸脲瞽怩骀弪┅换物轭瘐麸脲瞵轭溟汜翦翳轶鏖翳箝弪痱镧箦翩ㄢ蹑驽颦溴筱戾铉翳轭瘐舡麸脲瞽泔铘孱舂癌箦翩ㄢ蹑驽颦溴筱鲠祯轭瘐舡麸脲瞽泔铘孱舂ㄣ骀楹铛祆痫轭翦颟┅躅鏖钿痱雉邈戾è蝈篚祠ㄧ篌汜祆ㄧ篌轭轸箦悱泔铘屮珞蟓悱铒泸邃孱糸犰泔铘屮舡栳钿戾ㄧ篌礤盹蝙黹轭痿钺礤珞蟓悱铒镩洫磲脲骒徵骒徵螬糸礤蝈珞蟓悱铒汨犷铄飙忾钿轭珞轭瘐舡麸脲瞽泔铘孱徙趱犰礤汨豉疱秕麴豸麸脲蝈舡骒徵糸礤蝈悌┅躅鏖钿痱雉邈鲠祯弩ㄣ镱糸铛瀛铄邃邃蝈篚祠矧泔铘屮磲脲轭篝犷沐с镱翦吼趄ㄣ骀楹礤憝蝈泔铘屮舡栳钿戾х篌泗殇舂┅戾è狎蜥麸脲瞽踞蝌狴秕麴豸麸脲瞟┅ㄩ弪镳戾铉翳狎蜥┅铋狎蜥┅磲脲骒徵蟓扉篝ㄣ骀楹礤憝蝈蝈舡骒徵э憝蹰铘巢┅ㄧ篌汜祆ㄧ篌蝈戾狍瀛怩骀弪秕麴豸麸脲瞟┅麒孱轭瘐舡麸脲瞽怩骀弪ㄣ骀楹骘蝈殓瞽骝邋轭瘐舡麸脲瞽怩骀弪┅┅┅换换身痨屙孱趔翳骢钽糸镱犰轸镦珞筮徙沐痿唧邈咩镱翦换ㄤ彐躅徙沐痿箦ㄢ蹑驽脲泔铘屮舂⒘沣屦箦沲蜷豉泔铘屮骝镯蝈盹翦沆殄铘澡轶骢钽糸镱轫痨屙孱趔翳骢钽糸镱犰轸镦翳怯恿猩骢钽糸镱噻篌哚沣屦暨箦氵泔铘屮臾义趱蝾鲠祯弩狎搴孟卧晌张闻拍拍殒铒瞽紊态翳轶鲠祯轭溟汜翦翳狒犷雉桢礤篌徵轶屮疱泗邃忮骘蝈翳泔铘屮轶蝈徜孟卧咆翳泔铘屮翳狒轶躞邃麸蝈驽麸翳轶箴邈殒殂箦篌轱瘟团翳钺礤镦翳蝈盹翦痱轭汩疳抡破乓翳怩骀弪翳狒箬秕熹忮箦铘麸翳蝈盹翦箦蝣殂瀣矧紊殒翳弪轶铒铄邃麸箦钿盹蝈礤篌徵弩铺燎扉篝镦骒徵翳狒溴筱蜷忮鲠蜷秕痱镳弪糸弩镦翳箦篌轱町痫篌殁戾骒徵蠛耗盘徘和赵樟态阂判塘佻河叛张蚊努好衔片荷卧徘毫蜗陨团遗澡戾铉翳镦糸礤翳狒翳泔铘屮鏖祆忮鲠扉洚ㄣ桢汶豉疱怩骀弪鲥泗矧ㄣ桢汶豉疱泔铘屮矧铛祆泔铘屮舂ㄣ骀楹鏖翳骘蝈殓瞽镡赍泗è泔铘屮舡栳钿戾х篌泗殇舂篁悱钺礤х篌钺礤舂秕麴豸麸脲Ж后趄蹉珞蟓怩骀弪溴筱┅蝈舡骒徵э憝蹰铘巢糸礤蝈э憝蹰铘巢┅箦翩ㄣ骀楹礤憝蝈泔铘屮舡栳钿戾х篌泗殇舂ㄧ弭矧犰祜汜翦泔铘屮泔铘屮舂鏖翳怩骀弪溴筱ㄩ铕豸麸脲瞽怩骀弪怩骀弪戾è蝈篚祠ㄧ篌汜祆ㄧ篌徙沐痿箦悱泔铘屮豁轭矧泔铘屮舡栳钿戾汇镱翦舡栳钿戾珞蟓悱铒泸邃孱糸犰会沣屦麸颦泸邃栳钿戾轭瘐舡麸脲瞽怩骀弪婚铕豸怩骀弪珞蟓悱铒汨犷铄飙忾钿轭珞汇栳忾钿轭珞篁悱钺礤惑蜚钺礤ㄣ骀楹铛祆痫轭翦颟豁邈豉疱秕麴豸麸脲伙豸瘐麸脲蝈舡骒徵或弭骒徵糸礤蝈霍轫蝈ㄣ骀榄簌蠛铛祆痫轭翦颟讳屐彗狒邃泸邃栳钿戾┅┅躅鏖钿痱雉邈鲠祯弩ㄣ镱糸铛瀛铄邃邃蝈篚祠矧泔铘屮磲脲轭篝犷沐с镱翦吼趄ㄣ骀楹礤憝蝈泔铘屮舡栳钿戾х篌泗殇舂┅磲脲轭篝犷沐ь犴吼趄ㄣ骀楹礤憝蝈篁悱钺礤х篌钺礤舂麸脲瞽踞蝌狴秕麴豸麸脲瞟磲脲骒徵蟓扉篝ㄣ骀楹礤憝蝈蝈舡骒徵э憝蹰铘巢┅ㄣ骀楹礤憝蝈糸礤蝈э憝蹰铘巢┅ㄧ篌汜祆ㄧ篌蝈戾狍瀛怩骀弪秕麴豸麸脲瞟┅┅┅换换身痨屙孱趔珞筮黩狃换ㄤ彐躅黩狃ㄣ镱翦怩骀弪脲泔铈⒆蜥翳怡翦狎蜥轭抡破乓轭泸痿镧蜥痂殂黩狃疱颥躞轭翳箴邈殒殄孟卧咆援澡怩骀弪鏖祆忮孱泸痿邃殒孟纹轶铒瞽紊坍澡轶骢钽糸镱蝈趱蝾翳孱泸痿邃溽翎狍怡翦狎蜥犷箦泔钿怙镬遽蝈趱蝾鲠祯翳狒轭汩溽翦麒弭桢翳礤篌徵麽孱泸痿邃矧铒舢ㄣ桢汶豉疱泔铘屮泔铘屮舂鏖翳怩骀弪溴筱ㄩ铕豸骘蝈殓瞽溴筱怩骀弪ㄣ骀楹鏖翳骘蝈殓瞽镡赍泗è秕麴豸骘蝈殓瞽溴筱Ж后趄蹉珞蟓怩骀弪溴筱┅ㄣ镱姝篝狒洪铘┅ㄧ篌汜祆ㄧ篌黩狃ㄧ篌礤盹蝙黹轭痿泔铘屮舂ㄩ泔铈癌珞蟓悱耧瓠溴驷蹯轭瘐舡骘蝈殓瞽溴筱泔铈篝狒秕麴豸骘蝈殓瞽溴筱┅躅鏖钿痱雉邈鲠祯弩麸脲瞽踞蝌狴秕麴豸骘蝈殓瞽溴筱铒弪镳ㄣ骀楹礤憝蝈泔铈篝狒洪铘┅┅ㄧ篌汜祆ㄧ篌蝈戾狍瀛怩骀弪秕麴豸骘蝈殓瞽溴筱┅┅┅换换身痨屙孱趔珞筮躅黩狃换ㄤ彐躅躅黩狃ㄣ镱翦怩骀弪⒚镱鲥螋黩狃疱怩骀弪轭麸躞徕戾骘蝽孟卧咆轶翳箦沲蜷豉泔铘屮麸躞瀣抡破乓轶翳痱雉邈翦怡翦狎蜥澡轶骢钽糸镱蝈趱蝾翳躅黩狃疱怩骀弪狍麇祆狍怙镬遽轭溟汜糸铉麒弭桢翳矧殓轭犰礤篌徵麽孱泸痿邃ㄣ桢汶豉疱泔铘屮泔铘屮舂鏖翳怩骀弪溴筱ㄩ铕豸礤篌徵瀛怩骀弪怩骀弪ㄣ骀楹鏖翳骘蝈殓瞽镡赍泗è秕麴豸礤篌徵瀛怩骀弪Ж后趄蹉珞蟓怩骀弪溴筱┅ㄣ镱姝篝狒洪铘耧瓠篝狒х篌耧瓠舂ㄧ篌汜祆ㄧ篌躅黩狃ㄧ篌礤盹蝙黹轭痿泔铘屮舂轭瘐舡礤篌徵瀛怩骀弪秕麴豸礤篌徵瀛怩骀弪泔铈篝狒耧瓠篝狒濠躅鏖钿痱雉邈鲠祯弩麸脲瞽踞蝌狴秕麴豸礤篌徵瀛怩骀弪铒弪镳ㄣ骀楹礤憝蝈泔铈篝狒洪铘┅┅ㄧ篌汜祆ㄧ篌蝈戾狍瀛怩骀弪秕麴豸礤篌徵瀛怩骀弪┅┅┅换换抿邃孱糸犰轫痫螋换ㄤ彐疳蜥礤翦蝈玳篝弪骀榄骢钽糸镱螵Ж㈦蜮颠珞筮蝈玳篝弪哚沣屦麸蜻殇孱糸豉㈢篌腧獾唑彗轶翦蜻徙沐痿矧唛溴铘轸┅ㄤ彐躅腧獾蝈玳篝弪徙沐痿矧殇孱糸豉ㄦ殪濠⒁彗轶翦箦蝣弪殇孱糸豉粕膛轶脲翎骈戾泔铘衢铋铉翳泸邃孱糸犰麸忮躞邃ㄣ桢汶豉疱骈戾矧篝蜷铉疳翳钺礤┅戾è疳翳钺礤痱镡瀛骈戾疳翳钺礤骈戾┅┅躅戾篌疳翳钺礤ㄥ蝌矧⑺妁翎骈戾滹弩铒屮轶艉幄骈戾┅戾è钺礤篝蜷铉疳翳钺礤┅祜镳骘骀榄钺礤轭蝈玳篝弪骀榄骢钽糸镱螵骘骀榄骖ㄣ骀楹骘蝈殓瞽簌礅镬痫轭翦骀榄钺礤麒孱骀榄骖滹戾è蝈篚祠ㄣ骀楹骘蝈殓瞽骢钽犰飙痫轭翦骀榄骖ī后趄轭镯蹰铘巢┅麒孱ㄥ蝌矧蝈篚祠蜥轶瀛弪蝻蝈篚祠铋铋飑蝈趱蝾铋飑骈钺祆ㄥ蝌矧⒚秕熹铒骈钿徙沐痿矧骢钽糸镱┅┅